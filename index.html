diff --git a/index.html b/index.html
index c8029401212b530895e127be58622e0995f545a2..89b1a234e449f16cbf47a12d8ba902be93fd44fe 100644
--- a/index.html
+++ b/index.html
@@ -1,795 +1,955 @@
-diff --git a/index.html b/index.html
-index b59b7dad463b04d0c5eff116c5c20f67145a0068..195d57679a6f264c685b846713f5435b648a4d7e 100644
---- a/index.html
-+++ b/index.html
-@@ -1,103 +1,208 @@
- <!DOCTYPE html>
- <html lang="zh-CN">
- <head>
-     <meta charset="UTF-8">
-     <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
-     <title>å†¯é’°èŒœçš„VIPä¼šå‘˜å¡</title>
-     <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
-     <link rel="icon" type="image/png" href="https://i.imgur.com/OleuXpc.jpeg">
-     <style>
-         html, body { scroll-behavior: smooth; }
--        body {
--            font-family: 'Noto Sans SC', Arial, sans-serif;
--            display: flex;
--            justify-content: center;
--            align-items: flex-start;
-+        body {
-+            font-family: 'Noto Sans SC', Arial, sans-serif;
-+            display: flex;
-+            justify-content: center;
-+            align-items: flex-start;
-             min-height: 100vh;
-             background: linear-gradient(rgba(248, 225, 231, 0.8), rgba(248, 225, 231, 0.8)), url('https://i.imgur.com/FNv7b40.jpeg') no-repeat center center;
-             background-size: contain;
-             background-color: #f8e1e7;
-             margin: 0;
-             perspective: 1000px;
-             flex-direction: column;
-             transition: all 0.5s ease;
-             padding-top: 280px;
-             -webkit-user-select: none;
-             user-select: none;
--            position: relative;
--        }
-+            position: relative;
-+        }
-+
-+        .open-website-link {
-+            position: fixed;
-+            top: 16px;
-+            right: 16px;
-+            z-index: 150;
-+            padding: 10px 18px;
-+            border-radius: 999px;
-+            background: rgba(255, 255, 255, 0.85);
-+            color: #e60073;
-+            font-weight: 700;
-+            text-decoration: none;
-+            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
-+            transition: transform 0.2s ease, box-shadow 0.2s ease;
-+        }
-+
-+        .open-website-hint {
-+            position: fixed;
-+            top: 76px;
-+            right: 16px;
-+            width: min(320px, calc(100% - 32px));
-+            padding: 14px 16px;
-+            background: rgba(255, 255, 255, 0.9);
-+            border-radius: 16px;
-+            box-shadow: 0 12px 28px rgba(0, 0, 0, 0.15);
-+            backdrop-filter: blur(6px);
-+            color: #222;
-+            font-size: 14px;
-+            line-height: 1.5;
-+            z-index: 120;
-+        }
-+
-+        .open-website-hint ol {
-+            padding-left: 18px;
-+            margin: 6px 0 10px;
-+        }
-+
-+        .open-website-hint li {
-+            margin-bottom: 4px;
-+        }
-+
-+        .copy-link-btn {
-+            display: inline-flex;
-+            align-items: center;
-+            gap: 6px;
-+            border: none;
-+            border-radius: 999px;
-+            padding: 6px 14px;
-+            background: linear-gradient(135deg, #ff4f81, #40E0D0);
-+            color: #fff;
-+            font-weight: 600;
-+            cursor: pointer;
-+            box-shadow: 0 6px 14px rgba(255, 79, 129, 0.3);
-+        }
-+
-+        .copy-link-btn:active {
-+            transform: translateY(1px);
-+        }
-+
-+        .copy-toast {
-+            display: inline-block;
-+            margin-left: 8px;
-+            font-size: 13px;
-+            color: #28a745;
-+            opacity: 0;
-+            transition: opacity 0.3s ease;
-+        }
-+
-+        .copy-toast.visible {
-+            opacity: 1;
-+        }
-+
-+        body.dark-mode .open-website-link {
-+            background: rgba(17, 17, 17, 0.85);
-+            color: #40E0D0;
-+            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.4);
-+        }
-+
-+        body.dark-mode .open-website-hint {
-+            background: rgba(34, 34, 34, 0.9);
-+            color: #f5f5f5;
-+            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
-+        }
-+
-+        body.dark-mode .copy-link-btn {
-+            box-shadow: 0 6px 14px rgba(64, 224, 208, 0.35);
-+        }
-+
-+        .open-website-link:hover,
-+        .open-website-link:focus-visible,
-+        .copy-link-btn:focus-visible {
-+            transform: translateY(-2px);
-+            box-shadow: 0 10px 18px rgba(0, 0, 0, 0.2);
-+            outline: none;
-+        }
- 
-         body.dark-mode {
-             background: linear-gradient(rgba(51, 51, 51, 0.9), rgba(51, 51, 51, 0.9)), url('https://i.imgur.com/QhzgmZT.jpeg') no-repeat center center;
-             background-size: contain;
-             background-color: #333;
-             color: #fff;
-             overflow: hidden;
-         }
- 
-         body.dark-mode::before {
-             content: '';
-             position: absolute;
-             top: 0;
-             left: 0;
-             width: 100%;
-             height: 100%;
-             pointer-events: none;
-             background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><circle cx="50" cy="50" r="2" fill="white" opacity="0.7"/></svg>') repeat;
-             animation: twinkle 4s infinite;
-             z-index: 0;
-         }
-         @keyframes twinkle {
-             0%, 100% { opacity: 0.3; }
-             50% { opacity: 0.7; }
-         }
-         .star {
-             position: absolute;
-             width: 2px;
-             height: 2px;
-             background: #fff;
-             border-radius: 50%;
-             animation: sparkle 3s infinite;
-             z-index: 1;
-         }
-         @keyframes sparkle {
-             0%, 100% { opacity: 0; }
-             50% { opacity: 1; }
-         }
- 
--        @media (max-width: 390px) {
--            body {
--                background-size: auto 80%;
--                background-position: center top;
--                padding-top: 230px;
--            }
--            body.dark-mode {
--                background-size: auto 80%;
--                background-position: center top;
--            }
--        }
-+        @media (max-width: 390px) {
-+            body {
-+                background-size: auto 80%;
-+                background-position: center top;
-+                padding-top: 230px;
-+            }
-+            body.dark-mode {
-+                background-size: auto 80%;
-+                background-position: center top;
-+            }
-+            .open-website-link {
-+                position: static;
-+                display: inline-flex;
-+                margin: 12px auto 0;
-+            }
-+            .open-website-hint {
-+                position: static;
-+                margin: 12px auto 0;
-+                width: calc(100% - 32px);
-+            }
-+        }
- 
-         .card-container {
-             position: fixed;
-             top: 50px;
-             left: 50%;
-             transform: translateX(-50%);
-             width: 360px;
-             height: 220px;
-             transform-style: preserve-3d;
-             z-index: 100;
-             cursor: pointer;
-             transition: transform 0.6s ease;
-             -webkit-transform: translateX(-50%);
-         }
- 
-         .card-container.flipped {
-             transform: translateX(-50%) rotateY(180deg);
-             -webkit-transform: translateX(-50%) rotateY(180deg);
-         }
- 
-         .card {
-             position: absolute;
-             width: 100%;
-             height: 100%;
-             backface-visibility: hidden;
-@@ -376,52 +481,106 @@
-             width: 140px; 
-             text-align: center;
-         }
- 
-         .custom-reward {
-             margin-top: 5px;
-         }
- 
-         .history {
-             margin-top: 10px;
-             max-height: 120px;
-             overflow-y: auto;
-             font-size: 14px;
-             color: #333;
-         }
-         .history ul {
-             list-style: none;
-             padding: 0;
-         }
-         .history li {
-             padding: 3px 0;
-         }
-         .history li.add { color: #28a745; }
-         .history li.subtract { color: #dc3545; }
-         .history li.redeem { color: #007bff; }
--        .history li.daily { color: #17a2b8; }
--        .history li.latest { font-weight: 700; }
-+        .history li.daily { color: #17a2b8; }
-+        .history li.latest { font-weight: 700; }
-+
-+        .job-agent {
-+            display: flex;
-+            flex-direction: column;
-+            gap: 10px;
-+            color: #333;
-+        }
-+        .job-agent small {
-+            color: #777;
-+        }
-+        .job-agent-grid {
-+            display: grid;
-+            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
-+            gap: 10px;
-+        }
-+        .job-agent label {
-+            font-weight: 600;
-+            display: flex;
-+            flex-direction: column;
-+            font-size: 14px;
-+        }
-+        .job-agent input[type="text"],
-+        .job-agent textarea,
-+        .job-agent select {
-+            width: 100%;
-+            padding: 10px 12px;
-+            border: 2px solid #ff4f81;
-+            border-radius: 15px;
-+            background: #fff;
-+            color: #333;
-+            font-size: 14px;
-+            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
-+        }
-+        .job-agent textarea {
-+            min-height: 80px;
-+            resize: vertical;
-+        }
-+        #jobReply {
-+            min-height: 180px;
-+            font-family: 'Noto Sans SC', Arial, sans-serif;
-+            font-size: 14px;
-+            white-space: pre-line;
-+        }
-+        .dark-mode .job-agent {
-+            color: #fff;
-+        }
-+        .dark-mode .job-agent input[type="text"],
-+        .dark-mode .job-agent textarea,
-+        .dark-mode .job-agent select {
-+            background: #444;
-+            color: #fff;
-+            border-color: #777;
-+            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
-+        }
- 
-         #darkModeToggle, #audioToggle {
-             position: fixed;
-             top: 10px;
-             padding: 6px 12px;
-             border-radius: 15px;
-             font-size: 12px;
-             z-index: 101;
-         }
-         #darkModeToggle { right: 10px; }
-         #audioToggle { right: 80px; }
-         #chatBubble {
-             position: fixed;
-             width: 50px;
-             height: 50px;
-             background-color: #ff4f81;
-             border-radius: 25px;
-             display: flex;
-             align-items: center;
-             justify-content: center;
-             cursor: pointer;
-             z-index: 200;
-             color: #fff;
-             box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
-             -webkit-tap-highlight-color: transparent;
-@@ -792,54 +951,68 @@
-             .expiry { font-size: 14px; }
-             .qr-code { width: 100px; top: 60px; }
-             .back-content { margin-top: 70px; font-size: 14px; }
-             .back-header { font-size: 18px; }
-             .btn, select, input[type="number"], input[type="text"] {
-                 padding: 6px 12px;
-                 font-size: 12px;
-             }
-             select, input[type="number"], input[type="text"] { width: 120px; }
-             .history { max-height: 100px; font-size: 13px; }
-             #darkModeToggle, #audioToggle { font-size: 10px; padding: 5px 10px; }
-             #audioToggle { right: 60px; }
-             .collapsible { width: 95%; padding: 5px; }
-             #diaryEntry { height: 80px; }
-             #diaryList { max-height: 150px; }
-             #chatBubble { width: 40px; height: 40px; }
-             #chatBubble::after { font-size: 20px; }
-             .chat-container { width: 280px; max-height: 350px; }
-             #chatMessages { max-height: 250px; }
-             #chatInput { min-width: 120px; }
-             #chatInputArea button { padding: 3px 8px; min-width: 35px; }
-             #playlist { max-height: 120px; }
-         }
-     </style>
- </head>
--<body>
--    <div id="loadingScreen">
--        <div class="spinner"></div>
--    </div>
-+<body>
-+    <a class="open-website-link" href="https://vip-membership-b19fe.web.app/" target="_blank" rel="noopener">
-+        ğŸš€ æ‰“å¼€ç½‘ç«™ (vip-membership-b19fe.web.app)
-+    </a>
-+    <section class="open-website-hint" aria-live="polite">
-+        <p>ğŸ§­ æƒ³ä½“éªŒå®Œæ•´ç‰ˆï¼ŸæŒ‰ç…§ä»¥ä¸‹ä»»æ„æ–¹å¼å³å¯ï¼š</p>
-+        <ol>
-+            <li>ç›´æ¥ç‚¹å‡»å³ä¸Šè§’ã€Œæ‰“å¼€ç½‘ç«™ã€ï¼Œæ–°é¡µé¢ä¼šåœ¨æ–°æ ‡ç­¾é¡µåŠ è½½ã€‚</li>
-+            <li>å¦‚æœæµè§ˆå™¨æ‹¦æˆªäº†å¼¹çª—ï¼Œå¤åˆ¶ç½‘å€åæ‰‹åŠ¨åœ¨åœ°å€æ ç²˜è´´è¿›å…¥ã€‚</li>
-+        </ol>
-+        <button type="button" class="copy-link-btn" onclick="copyLiveSiteUrl()">
-+            ğŸ“‹ å¤åˆ¶ç½‘å€
-+        </button>
-+        <span id="copyLinkToast" class="copy-toast" role="status" aria-live="assertive"></span>
-+    </section>
-+    <div id="loadingScreen">
-+        <div class="spinner"></div>
-+    </div>
-     <button id="darkModeToggle" class="btn" onclick="toggleDarkMode()">åˆ‡æ¢é»‘æš—æ¨¡å¼</button>
-     <button id="audioToggle" class="btn" onclick="toggleAudio()">éŸ³ä¹å¼€å…³</button>
-     <audio id="backgroundMusic" loop>
-         <source src="https://www.dropbox.com/scl/fi/yiry4syd84w5uesrdehg4/SOUNDZ-under-GROUND-DJ-Okawari-Tabeyellow-Flower-Dance.mp3?rlkey=n00uozba5xd3po4iyiiogcfd7&st=d9gon05a&raw=1" type="audio/mpeg">
-         Your browser does not support the audio element.
-     </audio>
-     <div class="card-container" onclick="flipCard()">
-         <div class="card front">
-             <div class="bank-name">å¿ƒåŠ¨é“¶è¡Œ</div>
-             <img class="logo" loading="lazy" src="https://i.imgur.com/OleuXpc.jpeg" alt="Logo">
-             <img class="chip" loading="lazy" src="https://i.imgur.com/I836XHp.png" alt="Chip">
-             <div class="card-details">
-                 <p class="card-number">5201 8888 1314 9999</p>
-                 <p class="expiry">æœ‰æ•ˆæœŸè‡³: <strong>12/2099</strong></p>
-                 <p class="card-holder"><strong>å†¯é’°èŒœ</strong></p>
-             </div>
-         </div>
-         <div class="card back">
-             <img class="magnetic-stripe" loading="lazy" src="https://i.imgur.com/8ZLLYBn.jpeg" alt="Magnetic Stripe">
-             <img class="qr-code" loading="lazy" src="https://i.imgur.com/3ojYXPE.png" alt="QR Code">
-             <div class="back-content">
-                 <div class="back-header">å¿ƒåŠ¨é“¶è¡Œ é»‘é‡‘å¡</div>
-                 <p>ä¸“å±æƒç›Šä¸æœåŠ¡<br>ç»ˆèº«æœ‰æ•ˆ<br>å…¨çƒæ— å¿§æœåŠ¡<br>è”ç³»å®¢æœï¼š85000272</p>
-             </div>
-         </div>
-@@ -859,101 +1032,193 @@
-                 <input type="number" id="newRewardCost" min="1" placeholder="ç§¯åˆ†">
-                 <button class="btn" onclick="addReward()">æ·»åŠ å¥–åŠ±</button>
-             </div>
-             <div class="history">
-                 <h3>äº¤æ˜“è®°å½•</h3>
-                 <ul id="historyList"></ul>
-                 <button class="btn" onclick="clearTransactionHistory()">æ¸…ç©ºäº¤æ˜“è®°å½•</button>
-             </div>
-         </div>
-     </div>
- 
-     <div class="collapsible">
-         <h2 onclick="toggleSection(this)">æˆ‘çš„æ—¥è®°</h2>
-         <div class="content">
-             <textarea id="diaryEntry" placeholder="è®°å½•ä»Šå¤©çš„æƒ³æ³•..."></textarea>
-             <select id="diaryMood">
-                 <option value="happy">ğŸ˜Š å¼€å¿ƒ</option>
-                 <option value="sad">ğŸ˜¢ éš¾è¿‡</option>
-                 <option value="neutral">ğŸ˜ å¹³å¸¸</option>
-             </select>
-             <button class="btn" onclick="saveDiaryEntry()">ä¿å­˜</button>
-             <div id="diaryList"></div>
-         </div>
-     </div>
- 
--    <div class="collapsible">
--        <h2 onclick="toggleSection(this)">æˆ‘çš„æ­Œå•</h2>
--        <div class="content">
--            <div id="playlist"></div>
--        </div>
--    </div>
--
--    <div id="chatBubble"></div>
--    <div class="chat-container" id="chatContainer">
-+    <div class="collapsible">
-+        <h2 onclick="toggleSection(this)">æˆ‘çš„æ­Œå•</h2>
-+        <div class="content">
-+            <div id="playlist"></div>
-+        </div>
-+    </div>
-+
-+    <div class="collapsible">
-+        <h2 onclick="toggleSection(this)">æ–°åŠ å¡æ±‚èŒä»£ç†</h2>
-+        <div class="content job-agent">
-+            <p>æŠŠä½ çš„èŒä¸šè®¾å®šäº¤ç»™è¿™ä½è¿·ä½ ä»£ç†ï¼Œå¥¹ä¼šç”¨é¢„è®¾ä¿¡æ¯å¸®åŠ©ä½ å¿«é€Ÿå›åº”åœ¨æ–°åŠ å¡çš„èŒä½æœºä¼šï¼Œå¹¶ä¸»åŠ¨è¯´æ˜ä½ æ˜¯ä¸­å›½å…¬æ°‘ã€éœ€è¦é›‡ä¸»æ”¯æŒç­¾è¯ã€‚</p>
-+            <div class="job-agent-grid">
-+                <label>å§“å/ç½²å
-+                    <input type="text" id="agentName" value="å†¯é’°èŒœ">
-+                </label>
-+                <label>ä¸ªäººå¤´è¡”
-+                    <input type="text" id="agentTitle" value="æ•°æ®é©±åŠ¨çš„äº§å“è¿è¥ç»ç†">
-+                </label>
-+                <label>è”ç³»æ–¹å¼
-+                    <input type="text" id="agentContact" value="+65 8888 0000 ï½œ qian@example.com">
-+                </label>
-+                <label>å¸¸é©»/ç›®æ ‡åœ°ç‚¹
-+                    <input type="text" id="agentLocation" value="æ–°åŠ å¡">
-+                </label>
-+                <label>ç›®æ ‡å…¬å¸
-+                    <input type="text" id="jobCompany" placeholder="å¦‚ï¼šGrab">
-+                </label>
-+                <label>èŒä½åç§°
-+                    <input type="text" id="jobTitle" placeholder="å¦‚ï¼šProduct Manager">
-+                </label>
-+                <label>å›å¤è¯­æ°”
-+                    <select id="agentTone">
-+                        <option value="application">é¦–è½®ç”³è¯·</option>
-+                        <option value="followup">ç”³è¯·è·Ÿè¿›</option>
-+                        <option value="network">å†…æ¨/äººè„‰é—®å€™</option>
-+                    </select>
-+                </label>
-+            </div>
-+            <label>æ ¸å¿ƒä¼˜åŠ¿ï¼ˆä¿æŒä½ æƒ³è¦çš„ presetï¼‰
-+                <textarea id="agentSummary">æ‹¥æœ‰6å¹´æ”¯ä»˜ä¸ä¼šå‘˜ä¸šåŠ¡ç»éªŒï¼Œä¸“æ³¨å•†ä¸šåŒ–ç­–ç•¥ã€å¢é•¿å®éªŒå’Œè·¨åŒºåŸŸåˆä½œï¼Œèƒ½å¤Ÿåœ¨å¼ºç›‘ç®¡ç¯å¢ƒä¸­æŠŠæƒ³æ³•è½åœ°ã€‚</textarea>
-+            </label>
-+            <label>ä»£è¡¨æˆæœ/æŠ€èƒ½
-+                <textarea id="agentHighlights">å¸¦é¢†è·¨èŒèƒ½å°ç»„åœ¨6ä¸ªæœˆå†…æŠŠä»˜è´¹ä¼šå‘˜è½¬åŒ–ç‡æå‡31%
-+æ¨åŠ¨è¥é”€è‡ªåŠ¨åŒ–æµæ°´åŒæ¯”æå‡22%
-+ç†Ÿæ‚‰æ•°æ®ä»ªè¡¨ç›˜ã€SQLã€Looker ä¸ç”¨æˆ·è°ƒç ”</textarea>
-+            </label>
-+            <label>èŒä½å…³é”®ä¿¡æ¯æˆ–æ‹›è˜æ–¹çš„éœ€æ±‚
-+                <textarea id="jobDetails" placeholder="è¾“å…¥JDé‡Œä½ æƒ³å›åº”çš„é‡ç‚¹ã€å·¥å…·æˆ–è¦æ±‚"></textarea>
-+            </label>
-+            <label>é¢å¤–å¤‡æ³¨ï¼ˆå¦‚å¯å…¥èŒæ—¶é—´ã€è–ªèµ„æœŸæœ›ï¼‰
-+                <textarea id="agentExtras" placeholder="æƒ³é¢å¤–å‘ŠçŸ¥æ‹›è˜æ–¹çš„ä¿¡æ¯"></textarea>
-+            </label>
-+            <button class="btn" onclick="generateJobReply()">ç”Ÿæˆæ™ºèƒ½å›å¤</button>
-+            <label>ä»£ç†ç”Ÿæˆçš„æ±‚èŒå›å¤
-+                <textarea id="jobReply" readonly placeholder="è¿™é‡Œä¼šå‡ºç°å®Œæ•´çš„é‚®ä»¶/æ¶ˆæ¯è‰ç¨¿"></textarea>
-+            </label>
-+            <small>æç¤ºï¼šå›å¤ä¼šè‡ªåŠ¨æåˆ°ä½ æ˜¯ä¸­å›½å…¬æ°‘ã€éœ€è¦é›‡ä¸»æ”¯æŒæ–°åŠ å¡å·¥ä½œç­¾è¯ï¼ˆEmployment Pass/S Passï¼‰ã€‚</small>
-+        </div>
-+    </div>
-+
-+    <div id="chatBubble"></div>
-+    <div class="chat-container" id="chatContainer">
-         <div id="chatHeader">å®¢æœèŠå¤© (æ‹–åŠ¨ç§»åŠ¨ï¼Œç‚¹å‡»æ”¶èµ·)</div>
-         <div id="typingIndicator"></div>
-         <div id="chatMessages"></div>
-         <div id="chatInputArea">
-             <input type="text" id="chatInput" placeholder="è¾“å…¥æ¶ˆæ¯...">
-             <button class="btn" onclick="sendMessage()">å‘é€</button>
-             <button class="btn" id="voiceButton" onclick="startVoiceInput()">ğŸ¤</button>
-             <button class="btn" onclick="clearChat()">ğŸ§¹</button>
-         </div>
-     </div>
- 
-     <div id="spinner" class="spinner"></div>
-     <footer>Â© 2025 å¿ƒåŠ¨é“¶è¡Œ - ç”± é¥¶åšè‰¯ ç²¾å¿ƒè®¾è®¡</footer>
- 
-     <script type="module">
-         import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
-         import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, addDoc, deleteDoc, getDocs, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";
- 
-         const firebaseConfig = {
-             apiKey: "AIzaSyACDbq6EXRSNiNd8dGiPiTrt4mjpu5ri3w",
-             authDomain: "vip-membership-b19fe.firebaseapp.com",
-             projectId: "vip-membership-b19fe",
-             storageBucket: "vip-membership-b19fe.appspot.com",
-             messagingSenderId: "1098738124176",
-             appId: "1:1098738124176:web:77ec1c338f627026729f15"
-         };
- 
-         const app = initializeApp(firebaseConfig);
-         const db = getFirestore(app);
-         const userRef = doc(db, "users", "vip-user");
-         const transactionsRef = collection(userRef, "transactions");
-         const rewardsRef = collection(userRef, "rewards");
-         const chatsRef = collection(userRef, "chats");
-         const diaryRef = collection(userRef, "diary");
- 
--        let currentSender = "liang";
--        let recorder = null;
--        let isRecording = false;
--        let currentAudio = null;
--
--        async function loadPoints() {
--            const spinner = document.getElementById("spinner");
-+        let currentSender = "liang";
-+        let recorder = null;
-+        let isRecording = false;
-+        let currentAudio = null;
-+        let copyToastTimer = null;
-+
-+        function copyLiveSiteUrl() {
-+            const url = "https://vip-membership-b19fe.web.app/";
-+            const fallbackCopy = () => {
-+                const textarea = document.createElement("textarea");
-+                textarea.value = url;
-+                document.body.appendChild(textarea);
-+                textarea.select();
-+                try {
-+                    document.execCommand("copy");
-+                    showCopyToast("å·²å¤åˆ¶ï¼Œç²˜è´´åˆ°æµè§ˆå™¨åœ°å€æ å³å¯ï¼");
-+                } catch (err) {
-+                    showCopyToast("è¯·æ‰‹åŠ¨å¤åˆ¶ï¼š" + url);
-+                }
-+                document.body.removeChild(textarea);
-+            };
-+
-+            if (navigator.clipboard && navigator.clipboard.writeText) {
-+                navigator.clipboard.writeText(url)
-+                    .then(() => showCopyToast("å·²å¤åˆ¶ï¼Œç²˜è´´åˆ°æµè§ˆå™¨åœ°å€æ å³å¯ï¼"))
-+                    .catch(() => fallbackCopy());
-+            } else {
-+                fallbackCopy();
-+            }
-+        }
-+
-+        function showCopyToast(message) {
-+            const toast = document.getElementById("copyLinkToast");
-+            if (!toast) return;
-+            toast.textContent = message;
-+            toast.classList.add("visible");
-+            if (copyToastTimer) {
-+                clearTimeout(copyToastTimer);
-+            }
-+            copyToastTimer = setTimeout(() => {
-+                toast.classList.remove("visible");
-+            }, 2000);
-+        }
-+
-+        async function loadPoints() {
-+            const spinner = document.getElementById("spinner");
-             spinner.style.display = "block";
-             try {
-                 const docSnap = await getDoc(userRef);
-                 if (docSnap.exists()) {
-                     const data = docSnap.data();
-                     updatePointsDisplay(data.points || 0);
-                     updateStreakDisplay(data.streak || 0, data.lastCheckIn);
-                 } else {
-                     await setDoc(userRef, { points: 0, streak: 0, lastCheckIn: null });
-                     updatePointsDisplay(0);
-                     updateStreakDisplay(0, null);
-                 }
-                 loadHistory();
-                 loadRewards();
-                 startCountdown();
-                 loadPlaylist();
-             } catch (error) {
-                 console.error("åŠ è½½ç§¯åˆ†å¤±è´¥:", error);
-             }
-             spinner.style.display = "none";
-         }
- 
-         async function adjustPoints() {
-             const spinner = document.getElementById("spinner");
-             spinner.style.display = "block";
-@@ -1477,54 +1742,127 @@
-             const playlist = document.getElementById("playlist");
-             const songs = [
-                 { name: "Flower Dance", url: "https://www.dropbox.com/scl/fi/yiry4syd84w5uesrdehg4/SOUNDZ-under-GROUND-DJ-Okawari-Tabeyellow-Flower-Dance.mp3?rlkey=n00uozba5xd3po4iyiiogcfd7&st=d9gon05a&raw=1" },
-                 { name: "Need You Now", url: "https://www.dropbox.com/scl/fi/l08rq49ao7y8siv5vwa02/Lady-Antebellum-Need-You-Now.mp3?rlkey=1y7sbd3druy1g0mrafuwz1xof&st=d3f7r56a&raw=1" },
-                 { name: "Close to You", url: "https://www.dropbox.com/scl/fi/wy4v3cn11uwseh14hyb9a/Carpenters_They_Long_To_Be_Close_To_You.mp3?rlkey=oxh880tv5shrp6jygagxvw3t3&st=ocdxuzwc&raw=1" }
-             ];
- 
-             playlist.innerHTML = "";
-             songs.forEach((song, index) => {
-                 const div = document.createElement("div");
-                 const audio = document.createElement("audio");
-                 audio.controls = true;
-                 audio.src = song.url;
-                 audio.addEventListener("play", () => {
-                     if (currentAudio && currentAudio !== audio) {
-                         currentAudio.pause();
-                     }
-                     currentAudio = audio;
-                 });
-                 div.textContent = `${index + 1}. ${song.name} `;
-                 div.appendChild(audio);
-                 playlist.appendChild(div);
-             });
-         }
- 
--        function toggleSection(header) {
--            const content = header.nextElementSibling;
--            content.classList.toggle("active");
--        }
-+        function toggleSection(header) {
-+            const content = header.nextElementSibling;
-+            content.classList.toggle("active");
-+        }
-+
-+        function parseHighlights(text) {
-+            return text
-+                .split(/[\n,ï¼Œã€]/)
-+                .map(item => item.trim())
-+                .filter(Boolean);
-+        }
-+
-+        function generateJobReply() {
-+            const spinner = document.getElementById("spinner");
-+            spinner.style.display = "block";
-+
-+            const getValue = (id, fallback = "") => {
-+                const el = document.getElementById(id);
-+                return (el ? el.value.trim() : "") || fallback;
-+            };
-+
-+            const name = getValue("agentName", "å†¯é’°èŒœ");
-+            const title = getValue("agentTitle", "äº§å“è¿è¥ç»ç†");
-+            const contact = getValue("agentContact");
-+            const location = getValue("agentLocation", "æ–°åŠ å¡");
-+            const summary = getValue("agentSummary", "çƒ­çˆ±æ„å»ºä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„äº§å“ä½“éªŒã€‚");
-+            const highlights = parseHighlights(getValue("agentHighlights"));
-+            const jobCompany = getValue("jobCompany");
-+            const jobTitle = getValue("jobTitle");
-+            const jobDetails = getValue("jobDetails");
-+            const extras = getValue("agentExtras");
-+            const toneKey = getValue("agentTone", "application");
-+
-+            const toneProfiles = {
-+                application: {
-+                    greeting: "ä½ å¥½{{team}}ï¼š",
-+                    focus: "æ„Ÿè°¢ä½ ä»¬å‘å¸ƒ{{jobLine}}çš„æœºä¼šã€‚",
-+                    callToAction: "è‹¥æ–¹ä¾¿çš„è¯ï¼ŒæœŸå¾…çº¦ä¸€ä¸ªæ—¶é—´ï¼Œè®¨è®ºæˆ‘å¯ä»¥å¦‚ä½•å¸®åŠ©å›¢é˜Ÿåœ¨æ–°åŠ å¡å¸‚åœºè½åœ°æˆæœã€‚",
-+                    closing: "ç¥ä¸€åˆ‡é¡ºåˆ©ï¼ŒæœŸå¾…å›å¤ã€‚"
-+                },
-+                followup: {
-+                    greeting: "æ‚¨å¥½{{team}}ï¼š",
-+                    focus: "æˆ‘æƒ³è·Ÿè¿›ä¹‹å‰æäº¤çš„{{jobLine}}ç”³è¯·ï¼ŒåŒæ—¶è¡¥å……ä¸€äº›æˆ‘èƒ½å¤Ÿå³åˆ»è´¡çŒ®çš„æƒ³æ³•ã€‚",
-+                    callToAction: "å¦‚éœ€é¢å¤–ææ–™æˆ–æ¡ˆä¾‹ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šç«‹åˆ»è¡¥å……ã€‚",
-+                    closing: "æ„Ÿè°¢æŠ½ç©ºé˜…è¯»ã€‚"
-+                },
-+                network: {
-+                    greeting: "å—¨{{team}}ï¼š",
-+                    focus: "æˆ‘æƒ³äº†è§£è´µå¸ç›®å‰å…³äº{{jobLine}}çš„æ‹›è˜é‡ç‚¹ï¼Œå¹¶çœ‹çœ‹æ˜¯å¦æœ‰åˆä½œæˆ–å†…æ¨çš„å¯èƒ½ã€‚",
-+                    callToAction: "è‹¥å›¢é˜Ÿåˆé€‚ï¼Œè¿˜è¯·æŒ‡ç‚¹ä¸‹ä¸€æ­¥æˆ–æ¨èå¯ä»¥æ²Ÿé€šçš„åŒäº‹ã€‚",
-+                    closing: "å†æ¬¡æ„Ÿè°¢ï¼Œä¹Ÿç¥å·¥ä½œé¡ºåˆ©ï¼"
-+                }
-+            };
-+
-+            const toneProfile = toneProfiles[toneKey] || toneProfiles.application;
-+            const teamLabel = jobCompany ? `${jobCompany}å›¢é˜Ÿ` : "æ‹›è˜å›¢é˜Ÿ";
-+            const jobLine = jobTitle ? `${jobTitle} å²—ä½` : "çš„å²—ä½æœºä¼š";
-+            const companyLabel = jobCompany || "è´µå…¬å¸";
-+            const greeting = toneProfile.greeting.replace("{{team}}", teamLabel);
-+            const focusLine = toneProfile.focus.replace("{{jobLine}}", jobLine);
-+            const detailsLine = jobDetails ? `æˆ‘ç‰¹åˆ«å…³æ³¨åˆ°ï¼š${jobDetails}ã€‚` : "";
-+            const introParts = [`æˆ‘æ˜¯${name}`];
-+            if (title) introParts.push(`ä¸€å${title}`);
-+            if (location) introParts.push(`ç›®å‰å¸¸é©»${location}`);
-+            const intro = `${introParts.join("ï¼Œ")}ã€‚${summary}`;
-+            const highlightText = highlights.length ? `\næ ¸å¿ƒäº®ç‚¹ï¼š\n${highlights.map(item => `â€¢ ${item}`).join("\n")}` : "";
-+            const extrasText = extras ? `\né¢å¤–å¤‡æ³¨ï¼š${extras}` : "";
-+            const contactLine = contact ? `å¯é€šè¿‡ ${contact} è”ç³»æˆ‘ã€‚` : "å¯ä»¥éšæ—¶ä¸æˆ‘è”ç³»ã€‚";
-+            const visaLine = "ä½œä¸ºä¸­å›½å…¬æ°‘ï¼Œæˆ‘æ¸…æ¥šéœ€è¦é›‡ä¸»æ”¯æŒåŠç†æ–°åŠ å¡ Employment Pass æˆ– S Passï¼Œæ‰€æœ‰ææ–™å·²å‡†å¤‡å¥½å¹¶å¯ç§¯æé…åˆã€‚";
-+
-+            const body = `${focusLine} ${detailsLine}æˆ‘ç›¸ä¿¡è¿™äº›ç»éªŒèƒ½å¤Ÿå¸®åŠ©${companyLabel}åœ¨æ–°åŠ å¡å¸‚åœºæ›´å¿«å…‘ç°ç›®æ ‡ã€‚`;
-+            const message = `${greeting}\n\n${intro}\n${body}${highlightText}\n${visaLine}${extrasText}\n\n${toneProfile.callToAction}\n${contactLine}\n${toneProfile.closing}\n${name}`;
-+
-+            const replyBox = document.getElementById("jobReply");
-+            replyBox.value = message.trim();
-+            spinner.style.display = "none";
-+        }
- 
-         document.addEventListener("DOMContentLoaded", () => {
-             const chatBubble = document.getElementById("chatBubble");
-             const chatContainer = document.getElementById("chatContainer");
-             currentX = window.innerWidth - 70;
-             currentY = window.innerHeight - 70;
-             chatBubble.style.left = `${currentX}px`;
-             chatBubble.style.top = `${currentY}px`;
-             chatContainer.style.left = `${currentX}px`;
-             chatContainer.style.top = `${currentY + 60}px`;
- 
-             chatBubble.addEventListener("mousedown", startDragging);
-             chatContainer.addEventListener("mousedown", startDragging);
-             document.addEventListener("mousemove", drag);
-             document.addEventListener("mouseup", stopDragging);
-             chatBubble.addEventListener("touchstart", startDragging);
-             chatContainer.addEventListener("touchstart", startDragging);
-             document.addEventListener("touchmove", drag);
-             document.addEventListener("touchend", stopDragging);
-             chatBubble.addEventListener("click", (e) => { if (!isDragging) toggleChat(); });
- 
-             document.getElementById("audioToggle").textContent = "å¼€å¯éŸ³ä¹";
-             if (localStorage.getItem("darkMode") === "true") {
-                 document.body.classList.add("dark-mode");
-                 addStars();
-@@ -1535,31 +1873,32 @@
- 
-             const loadingScreen = document.getElementById("loadingScreen");
-             setTimeout(() => {
-                 loadingScreen.classList.add("fade-out");
-                 setTimeout(() => loadingScreen.style.display = "none", 500);
-             }, 1000);
-         });
- 
-         document.getElementById("chatInput").addEventListener("keypress", (e) => {
-             if (e.key === "Enter") sendMessage();
-         });
- 
-         window.adjustPoints = adjustPoints;
-         window.redeemSpecificReward = redeemSpecificReward;
-         window.addReward = addReward;
-         window.deleteReward = deleteReward;
-         window.sendMessage = sendMessage;
-         window.clearChat = clearChat;
-         window.startVoiceInput = startVoiceInput;
-         window.toggleChat = toggleChat;
-         window.toggleDarkMode = toggleDarkMode;
-         window.flipCard = flipCard;
-         window.toggleAudio = toggleAudio;
-         window.clearTransactionHistory = clearTransactionHistory;
-         window.saveDiaryEntry = saveDiaryEntry;
--        window.deleteDiaryEntry = deleteDiaryEntry;
--        window.dailyCheckIn = dailyCheckIn;
--        window.toggleSection = toggleSection;
--    </script>
--</body>
--</html>
-\ No newline at end of file
-+        window.deleteDiaryEntry = deleteDiaryEntry;
-+        window.dailyCheckIn = dailyCheckIn;
-+        window.toggleSection = toggleSection;
-+        window.generateJobReply = generateJobReply;
-+    </script>
-+</body>
-+</html>
+ <!DOCTYPE html>
+ <html lang="zh-CN">
+ <head>
+     <meta charset="UTF-8">
+     <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
+     <title>å†¯é’°èŒœçš„VIPä¼šå‘˜å¡</title>
+     <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
+     <link rel="icon" type="image/png" href="https://i.imgur.com/OleuXpc.jpeg">
+     <style>
+         html, body { scroll-behavior: smooth; }
+        body {
+            font-family: 'Noto Sans SC', Arial, sans-serif;
+            display: flex;
+            justify-content: center;
+            align-items: flex-start;
+             min-height: 100vh;
+             background: linear-gradient(rgba(248, 225, 231, 0.8), rgba(248, 225, 231, 0.8)), url('https://i.imgur.com/FNv7b40.jpeg') no-repeat center center;
+             background-size: contain;
+             background-color: #f8e1e7;
+             margin: 0;
+             perspective: 1000px;
+             flex-direction: column;
+             transition: all 0.5s ease;
+             padding-top: 280px;
+             -webkit-user-select: none;
+             user-select: none;
+            position: relative;
+        }
+
+        .open-website-link {
+            position: fixed;
+            top: 16px;
+            right: 16px;
+            z-index: 150;
+            padding: 10px 18px;
+            border-radius: 999px;
+            background: rgba(255, 255, 255, 0.85);
+            color: #e60073;
+            font-weight: 700;
+            text-decoration: none;
+            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
+            transition: transform 0.2s ease, box-shadow 0.2s ease;
+        }
+
+        .open-website-hint {
+            position: fixed;
+            top: 76px;
+            right: 16px;
+            width: min(320px, calc(100% - 32px));
+            padding: 14px 16px;
+            background: rgba(255, 255, 255, 0.9);
+            border-radius: 16px;
+            box-shadow: 0 12px 28px rgba(0, 0, 0, 0.15);
+            backdrop-filter: blur(6px);
+            color: #222;
+            font-size: 14px;
+            line-height: 1.5;
+            z-index: 120;
+        }
+
+        .open-website-hint ol {
+            padding-left: 18px;
+            margin: 6px 0 10px;
+        }
+
+        .open-website-hint li {
+            margin-bottom: 4px;
+        }
+
+        .copy-link-btn {
+            display: inline-flex;
+            align-items: center;
+            gap: 6px;
+            border: none;
+            border-radius: 999px;
+            padding: 6px 14px;
+            background: linear-gradient(135deg, #ff4f81, #40E0D0);
+            color: #fff;
+            font-weight: 600;
+            cursor: pointer;
+            box-shadow: 0 6px 14px rgba(255, 79, 129, 0.3);
+        }
+
+        .copy-link-btn:active {
+            transform: translateY(1px);
+        }
+
+        .copy-toast {
+            display: inline-block;
+            margin-left: 8px;
+            font-size: 13px;
+            color: #28a745;
+            opacity: 0;
+            transition: opacity 0.3s ease;
+        }
+
+        .copy-toast.visible {
+            opacity: 1;
+        }
+
+        body.dark-mode .open-website-link {
+            background: rgba(17, 17, 17, 0.85);
+            color: #40E0D0;
+            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.4);
+        }
+
+        body.dark-mode .open-website-hint {
+            background: rgba(34, 34, 34, 0.9);
+            color: #f5f5f5;
+            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
+        }
+
+        body.dark-mode .copy-link-btn {
+            box-shadow: 0 6px 14px rgba(64, 224, 208, 0.35);
+        }
+
+        .open-website-link:hover,
+        .open-website-link:focus-visible,
+        .copy-link-btn:focus-visible {
+            transform: translateY(-2px);
+            box-shadow: 0 10px 18px rgba(0, 0, 0, 0.2);
+            outline: none;
+        }
+ 
+         body.dark-mode {
+             background: linear-gradient(rgba(51, 51, 51, 0.9), rgba(51, 51, 51, 0.9)), url('https://i.imgur.com/QhzgmZT.jpeg') no-repeat center center;
+             background-size: contain;
+             background-color: #333;
+             color: #fff;
+             overflow: hidden;
+         }
+ 
+         body.dark-mode::before {
+             content: '';
+             position: absolute;
+             top: 0;
+             left: 0;
+             width: 100%;
+             height: 100%;
+             pointer-events: none;
+             background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><circle cx="50" cy="50" r="2" fill="white" opacity="0.7"/></svg>') repeat;
+             animation: twinkle 4s infinite;
+             z-index: 0;
+         }
+         @keyframes twinkle {
+             0%, 100% { opacity: 0.3; }
+             50% { opacity: 0.7; }
+         }
+         .star {
+             position: absolute;
+             width: 2px;
+             height: 2px;
+             background: #fff;
+             border-radius: 50%;
+             animation: sparkle 3s infinite;
+             z-index: 1;
+         }
+         @keyframes sparkle {
+             0%, 100% { opacity: 0; }
+             50% { opacity: 1; }
+         }
+ 
+        @media (max-width: 390px) {
+            body {
+                background-size: auto 80%;
+                background-position: center top;
+                padding-top: 230px;
+            }
+            body.dark-mode {
+                background-size: auto 80%;
+                background-position: center top;
+            }
+            .open-website-link {
+                position: static;
+                display: inline-flex;
+                margin: 12px auto 0;
+            }
+            .open-website-hint {
+                position: static;
+                margin: 12px auto 0;
+                width: calc(100% - 32px);
+            }
+        }
+ 
+         .card-container {
+             position: fixed;
+             top: 50px;
+             left: 50%;
+             transform: translateX(-50%);
+             width: 360px;
+             height: 220px;
+             transform-style: preserve-3d;
+             z-index: 100;
+             cursor: pointer;
+             transition: transform 0.6s ease;
+             -webkit-transform: translateX(-50%);
+         }
+ 
+         .card-container.flipped {
+             transform: translateX(-50%) rotateY(180deg);
+             -webkit-transform: translateX(-50%) rotateY(180deg);
+         }
+ 
+         .card {
+             position: absolute;
+             width: 100%;
+             height: 100%;
+             backface-visibility: hidden;
+             width: 140px; 
+             text-align: center;
+         }
+ 
+         .custom-reward {
+             margin-top: 5px;
+         }
+ 
+         .history {
+             margin-top: 10px;
+             max-height: 120px;
+             overflow-y: auto;
+             font-size: 14px;
+             color: #333;
+         }
+         .history ul {
+             list-style: none;
+             padding: 0;
+         }
+         .history li {
+             padding: 3px 0;
+         }
+         .history li.add { color: #28a745; }
+         .history li.subtract { color: #dc3545; }
+         .history li.redeem { color: #007bff; }
+        .history li.daily { color: #17a2b8; }
+        .history li.latest { font-weight: 700; }
+
+        .job-agent,
+        .honor-coach {
+            display: flex;
+            flex-direction: column;
+            gap: 10px;
+            color: #333;
+        }
+        .job-agent small,
+        .honor-coach small {
+            color: #777;
+        }
+        .job-agent-grid,
+        .honor-coach-grid {
+            display: grid;
+            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
+            gap: 10px;
+        }
+        .job-agent label,
+        .honor-coach label {
+            font-weight: 600;
+            display: flex;
+            flex-direction: column;
+            font-size: 14px;
+        }
+        .job-agent input[type="text"],
+        .honor-coach input[type="text"],
+        .job-agent textarea,
+        .honor-coach textarea,
+        .job-agent select,
+        .honor-coach select {
+            width: 100%;
+            padding: 10px 12px;
+            border: 2px solid #ff4f81;
+            border-radius: 15px;
+            background: #fff;
+            color: #333;
+            font-size: 14px;
+            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
+        }
+        .job-agent textarea,
+        .honor-coach textarea {
+            min-height: 80px;
+            resize: vertical;
+        }
+        #jobReply {
+            min-height: 180px;
+            font-family: 'Noto Sans SC', Arial, sans-serif;
+            font-size: 14px;
+            white-space: pre-line;
+        }
+        #honorCoachOutput {
+            min-height: 160px;
+            border-radius: 18px;
+            border: 2px dashed rgba(255, 79, 129, 0.5);
+            padding: 16px;
+            background: rgba(255, 255, 255, 0.7);
+            line-height: 1.6;
+        }
+        .dark-mode .job-agent,
+        .dark-mode .honor-coach {
+            color: #fff;
+        }
+        .dark-mode .job-agent input[type="text"],
+        .dark-mode .honor-coach input[type="text"],
+        .dark-mode .job-agent textarea,
+        .dark-mode .honor-coach textarea,
+        .dark-mode .job-agent select,
+        .dark-mode .honor-coach select {
+            background: #444;
+            color: #fff;
+            border-color: #777;
+            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
+        }
+        .dark-mode #honorCoachOutput {
+            background: rgba(0, 0, 0, 0.4);
+            border-color: rgba(64, 224, 208, 0.5);
+        }
+ 
+         #darkModeToggle, #audioToggle {
+             position: fixed;
+             top: 10px;
+             padding: 6px 12px;
+             border-radius: 15px;
+             font-size: 12px;
+             z-index: 101;
+         }
+         #darkModeToggle { right: 10px; }
+         #audioToggle { right: 80px; }
+         #chatBubble {
+             position: fixed;
+             width: 50px;
+             height: 50px;
+             background-color: #ff4f81;
+             border-radius: 25px;
+             display: flex;
+             align-items: center;
+             justify-content: center;
+             cursor: pointer;
+             z-index: 200;
+             color: #fff;
+             box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
+             -webkit-tap-highlight-color: transparent;
+             .expiry { font-size: 14px; }
+             .qr-code { width: 100px; top: 60px; }
+             .back-content { margin-top: 70px; font-size: 14px; }
+             .back-header { font-size: 18px; }
+             .btn, select, input[type="number"], input[type="text"] {
+                 padding: 6px 12px;
+                 font-size: 12px;
+             }
+             select, input[type="number"], input[type="text"] { width: 120px; }
+             .history { max-height: 100px; font-size: 13px; }
+             #darkModeToggle, #audioToggle { font-size: 10px; padding: 5px 10px; }
+             #audioToggle { right: 60px; }
+             .collapsible { width: 95%; padding: 5px; }
+             #diaryEntry { height: 80px; }
+             #diaryList { max-height: 150px; }
+             #chatBubble { width: 40px; height: 40px; }
+             #chatBubble::after { font-size: 20px; }
+             .chat-container { width: 280px; max-height: 350px; }
+             #chatMessages { max-height: 250px; }
+             #chatInput { min-width: 120px; }
+             #chatInputArea button { padding: 3px 8px; min-width: 35px; }
+             #playlist { max-height: 120px; }
+         }
+     </style>
+ </head>
+<body>
+    <a class="open-website-link" href="https://vip-membership-b19fe.web.app/" target="_blank" rel="noopener">
+        ğŸš€ æ‰“å¼€ç½‘ç«™ (vip-membership-b19fe.web.app)
+    </a>
+    <section class="open-website-hint" aria-live="polite">
+        <p>ğŸ§­ æƒ³ä½“éªŒå®Œæ•´ç‰ˆï¼ŸæŒ‰ç…§ä»¥ä¸‹ä»»æ„æ–¹å¼å³å¯ï¼š</p>
+        <ol>
+            <li>ç›´æ¥ç‚¹å‡»å³ä¸Šè§’ã€Œæ‰“å¼€ç½‘ç«™ã€ï¼Œæ–°é¡µé¢ä¼šåœ¨æ–°æ ‡ç­¾é¡µåŠ è½½ã€‚</li>
+            <li>å¦‚æœæµè§ˆå™¨æ‹¦æˆªäº†å¼¹çª—ï¼Œå¤åˆ¶ç½‘å€åæ‰‹åŠ¨åœ¨åœ°å€æ ç²˜è´´è¿›å…¥ã€‚</li>
+        </ol>
+        <button type="button" class="copy-link-btn" onclick="copyLiveSiteUrl()">
+            ğŸ“‹ å¤åˆ¶ç½‘å€
+        </button>
+        <span id="copyLinkToast" class="copy-toast" role="status" aria-live="assertive"></span>
+    </section>
+    <div id="loadingScreen">
+        <div class="spinner"></div>
+    </div>
+     <button id="darkModeToggle" class="btn" onclick="toggleDarkMode()">åˆ‡æ¢é»‘æš—æ¨¡å¼</button>
+     <button id="audioToggle" class="btn" onclick="toggleAudio()">éŸ³ä¹å¼€å…³</button>
+     <audio id="backgroundMusic" loop>
+         <source src="https://www.dropbox.com/scl/fi/yiry4syd84w5uesrdehg4/SOUNDZ-under-GROUND-DJ-Okawari-Tabeyellow-Flower-Dance.mp3?rlkey=n00uozba5xd3po4iyiiogcfd7&st=d9gon05a&raw=1" type="audio/mpeg">
+         Your browser does not support the audio element.
+     </audio>
+     <div class="card-container" onclick="flipCard()">
+         <div class="card front">
+             <div class="bank-name">å¿ƒåŠ¨é“¶è¡Œ</div>
+             <img class="logo" loading="lazy" src="https://i.imgur.com/OleuXpc.jpeg" alt="Logo">
+             <img class="chip" loading="lazy" src="https://i.imgur.com/I836XHp.png" alt="Chip">
+             <div class="card-details">
+                 <p class="card-number">5201 8888 1314 9999</p>
+                 <p class="expiry">æœ‰æ•ˆæœŸè‡³: <strong>12/2099</strong></p>
+                 <p class="card-holder"><strong>å†¯é’°èŒœ</strong></p>
+             </div>
+         </div>
+         <div class="card back">
+             <img class="magnetic-stripe" loading="lazy" src="https://i.imgur.com/8ZLLYBn.jpeg" alt="Magnetic Stripe">
+             <img class="qr-code" loading="lazy" src="https://i.imgur.com/3ojYXPE.png" alt="QR Code">
+             <div class="back-content">
+                 <div class="back-header">å¿ƒåŠ¨é“¶è¡Œ é»‘é‡‘å¡</div>
+                 <p>ä¸“å±æƒç›Šä¸æœåŠ¡<br>ç»ˆèº«æœ‰æ•ˆ<br>å…¨çƒæ— å¿§æœåŠ¡<br>è”ç³»å®¢æœï¼š85000272</p>
+             </div>
+         </div>
+                 <input type="number" id="newRewardCost" min="1" placeholder="ç§¯åˆ†">
+                 <button class="btn" onclick="addReward()">æ·»åŠ å¥–åŠ±</button>
+             </div>
+             <div class="history">
+                 <h3>äº¤æ˜“è®°å½•</h3>
+                 <ul id="historyList"></ul>
+                 <button class="btn" onclick="clearTransactionHistory()">æ¸…ç©ºäº¤æ˜“è®°å½•</button>
+             </div>
+         </div>
+     </div>
+ 
+     <div class="collapsible">
+         <h2 onclick="toggleSection(this)">æˆ‘çš„æ—¥è®°</h2>
+         <div class="content">
+             <textarea id="diaryEntry" placeholder="è®°å½•ä»Šå¤©çš„æƒ³æ³•..."></textarea>
+             <select id="diaryMood">
+                 <option value="happy">ğŸ˜Š å¼€å¿ƒ</option>
+                 <option value="sad">ğŸ˜¢ éš¾è¿‡</option>
+                 <option value="neutral">ğŸ˜ å¹³å¸¸</option>
+             </select>
+             <button class="btn" onclick="saveDiaryEntry()">ä¿å­˜</button>
+             <div id="diaryList"></div>
+         </div>
+     </div>
+ 
+    <div class="collapsible">
+        <h2 onclick="toggleSection(this)">æˆ‘çš„æ­Œå•</h2>
+        <div class="content">
+            <div id="playlist"></div>
+        </div>
+    </div>
+
+    <div class="collapsible">
+        <h2 onclick="toggleSection(this)">æ–°åŠ å¡æ±‚èŒä»£ç†</h2>
+        <div class="content job-agent">
+            <p>æŠŠä½ çš„èŒä¸šè®¾å®šäº¤ç»™è¿™ä½è¿·ä½ ä»£ç†ï¼Œå¥¹ä¼šç”¨é¢„è®¾ä¿¡æ¯å¸®åŠ©ä½ å¿«é€Ÿå›åº”åœ¨æ–°åŠ å¡çš„èŒä½æœºä¼šï¼Œå¹¶ä¸»åŠ¨è¯´æ˜ä½ æ˜¯ä¸­å›½å…¬æ°‘ã€éœ€è¦é›‡ä¸»æ”¯æŒç­¾è¯ã€‚</p>
+            <div class="job-agent-grid">
+                <label>å§“å/ç½²å
+                    <input type="text" id="agentName" value="å†¯é’°èŒœ">
+                </label>
+                <label>ä¸ªäººå¤´è¡”
+                    <input type="text" id="agentTitle" value="æ•°æ®é©±åŠ¨çš„äº§å“è¿è¥ç»ç†">
+                </label>
+                <label>è”ç³»æ–¹å¼
+                    <input type="text" id="agentContact" value="+65 8888 0000 ï½œ qian@example.com">
+                </label>
+                <label>å¸¸é©»/ç›®æ ‡åœ°ç‚¹
+                    <input type="text" id="agentLocation" value="æ–°åŠ å¡">
+                </label>
+                <label>ç›®æ ‡å…¬å¸
+                    <input type="text" id="jobCompany" placeholder="å¦‚ï¼šGrab">
+                </label>
+                <label>èŒä½åç§°
+                    <input type="text" id="jobTitle" placeholder="å¦‚ï¼šProduct Manager">
+                </label>
+                <label>å›å¤è¯­æ°”
+                    <select id="agentTone">
+                        <option value="application">é¦–è½®ç”³è¯·</option>
+                        <option value="followup">ç”³è¯·è·Ÿè¿›</option>
+                        <option value="network">å†…æ¨/äººè„‰é—®å€™</option>
+                    </select>
+                </label>
+            </div>
+            <label>æ ¸å¿ƒä¼˜åŠ¿ï¼ˆä¿æŒä½ æƒ³è¦çš„ presetï¼‰
+                <textarea id="agentSummary">æ‹¥æœ‰6å¹´æ”¯ä»˜ä¸ä¼šå‘˜ä¸šåŠ¡ç»éªŒï¼Œä¸“æ³¨å•†ä¸šåŒ–ç­–ç•¥ã€å¢é•¿å®éªŒå’Œè·¨åŒºåŸŸåˆä½œï¼Œèƒ½å¤Ÿåœ¨å¼ºç›‘ç®¡ç¯å¢ƒä¸­æŠŠæƒ³æ³•è½åœ°ã€‚</textarea>
+            </label>
+            <label>ä»£è¡¨æˆæœ/æŠ€èƒ½
+                <textarea id="agentHighlights">å¸¦é¢†è·¨èŒèƒ½å°ç»„åœ¨6ä¸ªæœˆå†…æŠŠä»˜è´¹ä¼šå‘˜è½¬åŒ–ç‡æå‡31%
+æ¨åŠ¨è¥é”€è‡ªåŠ¨åŒ–æµæ°´åŒæ¯”æå‡22%
+ç†Ÿæ‚‰æ•°æ®ä»ªè¡¨ç›˜ã€SQLã€Looker ä¸ç”¨æˆ·è°ƒç ”</textarea>
+            </label>
+            <label>èŒä½å…³é”®ä¿¡æ¯æˆ–æ‹›è˜æ–¹çš„éœ€æ±‚
+                <textarea id="jobDetails" placeholder="è¾“å…¥JDé‡Œä½ æƒ³å›åº”çš„é‡ç‚¹ã€å·¥å…·æˆ–è¦æ±‚"></textarea>
+            </label>
+            <label>é¢å¤–å¤‡æ³¨ï¼ˆå¦‚å¯å…¥èŒæ—¶é—´ã€è–ªèµ„æœŸæœ›ï¼‰
+                <textarea id="agentExtras" placeholder="æƒ³é¢å¤–å‘ŠçŸ¥æ‹›è˜æ–¹çš„ä¿¡æ¯"></textarea>
+            </label>
+            <button class="btn" onclick="generateJobReply()">ç”Ÿæˆæ™ºèƒ½å›å¤</button>
+            <label>ä»£ç†ç”Ÿæˆçš„æ±‚èŒå›å¤
+                <textarea id="jobReply" readonly placeholder="è¿™é‡Œä¼šå‡ºç°å®Œæ•´çš„é‚®ä»¶/æ¶ˆæ¯è‰ç¨¿"></textarea>
+            </label>
+            <small>æç¤ºï¼šå›å¤ä¼šè‡ªåŠ¨æåˆ°ä½ æ˜¯ä¸­å›½å…¬æ°‘ã€éœ€è¦é›‡ä¸»æ”¯æŒæ–°åŠ å¡å·¥ä½œç­¾è¯ï¼ˆEmployment Pass/S Passï¼‰ã€‚</small>
+        </div>
+    </div>
+
+    <div class="collapsible">
+        <h2 onclick="toggleSection(this)">ç‹è€…è£è€€ AI æ•™ç»ƒ</h2>
+        <div class="content honor-coach">
+            <p>è¾“å…¥è‹±é›„ã€åˆ†è·¯å’Œä½ æƒ³å¼ºè°ƒçš„æ‰“æ³•ï¼Œè¿™ä½éšèº«æ•™ç»ƒä¼šç«‹åˆ»ç»™å‡ºè£…å¤‡é¡ºåºã€é“­æ–‡/ç¬¦æ–‡ä»¥åŠå®æˆ˜èŠ‚å¥å»ºè®®ï¼Œå¸®åŠ©ä½ åœ¨ã€Šç‹è€…è£è€€ã€‹ä¸­æ›´å¿«ä¸Šæ˜Ÿã€‚</p>
+            <div class="honor-coach-grid">
+                <label>è‹±é›„
+                    <select id="honorHero">
+                        <option value="éœ²å¨œ">éœ²å¨œ</option>
+                        <option value="æç™½">æç™½</option>
+                        <option value="ç‹„ä»æ°">ç‹„ä»æ°</option>
+                        <option value="æ¾œ">æ¾œ</option>
+                        <option value="ç‹æ˜­å›">ç‹æ˜­å›</option>
+                    </select>
+                </label>
+                <label>åˆ†è·¯/å®šä½
+                    <select id="honorLane">
+                        <option value="æ‰“é‡">æ‰“é‡</option>
+                        <option value="å¯¹æŠ—è·¯">å¯¹æŠ—è·¯</option>
+                        <option value="ä¸­è·¯">ä¸­è·¯</option>
+                        <option value="å‘è‚²è·¯">å‘è‚²è·¯</option>
+                        <option value="æ¸¸èµ°">æ¸¸èµ°</option>
+                    </select>
+                </label>
+                <label>æ‰“æ³•å€¾å‘
+                    <select id="honorStyle">
+                        <option value="ç¨³å¥è¿è¥">ç¨³å¥è¿è¥</option>
+                        <option value="æé™è¿›æ”»">æé™è¿›æ”»</option>
+                        <option value="åè¹²åæ‰“">åè¹²åæ‰“</option>
+                        <option value="å¸¦çº¿ç‰µåˆ¶">å¸¦çº¿ç‰µåˆ¶</option>
+                    </select>
+                </label>
+            </div>
+            <label>ä¸ªäººè¡¥å……ï¼ˆæ“…é•¿è¿æ‹›ã€æƒ³ç»ƒçš„ç»†èŠ‚ï¼‰
+                <input type="text" id="honorFocus" placeholder="ä¾‹å¦‚ï¼šæ“…é•¿å°è§„æ¨¡ç»•åã€æƒ³ç»ƒæé™æ§åˆ¶"> 
+            </label>
+            <label>æ•Œæ–¹é˜µå®¹/éœ€è¦é’ˆå¯¹çš„äºº
+                <textarea id="honorEnemy" placeholder="ä¾‹å¦‚ï¼šæ•Œæ–¹æœ‰ç›¾å±±+é²ç­ï¼Œéœ€è¦æ‰“åæ’"></textarea>
+            </label>
+            <button class="btn" onclick="generateHonorGuide()">ç”Ÿæˆç‹è€…å‡ºè£… & é“­æ–‡å»ºè®®</button>
+            <div id="honorCoachOutput" aria-live="polite"></div>
+            <small>æç¤ºï¼šå»ºè®®ä¼šç»“åˆç‰ˆæœ¬å¸¸è§æ€è·¯ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠç”Ÿæˆçš„æ–‡å­—å¤åˆ¶åˆ°é˜Ÿå‹/æœ‹å‹é‚£é‡Œï¼Œæ–¹ä¾¿äº¤æµæˆ˜æœ¯ã€‚</small>
+        </div>
+    </div>
+
+    <div id="chatBubble"></div>
+    <div class="chat-container" id="chatContainer">
+         <div id="chatHeader">å®¢æœèŠå¤© (æ‹–åŠ¨ç§»åŠ¨ï¼Œç‚¹å‡»æ”¶èµ·)</div>
+         <div id="typingIndicator"></div>
+         <div id="chatMessages"></div>
+         <div id="chatInputArea">
+             <input type="text" id="chatInput" placeholder="è¾“å…¥æ¶ˆæ¯...">
+             <button class="btn" onclick="sendMessage()">å‘é€</button>
+             <button class="btn" id="voiceButton" onclick="startVoiceInput()">ğŸ¤</button>
+             <button class="btn" onclick="clearChat()">ğŸ§¹</button>
+         </div>
+     </div>
+ 
+     <div id="spinner" class="spinner"></div>
+     <footer>Â© 2025 å¿ƒåŠ¨é“¶è¡Œ - ç”± é¥¶åšè‰¯ ç²¾å¿ƒè®¾è®¡</footer>
+ 
+     <script type="module">
+         import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
+         import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, addDoc, deleteDoc, getDocs, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";
+ 
+         const firebaseConfig = {
+             apiKey: "AIzaSyACDbq6EXRSNiNd8dGiPiTrt4mjpu5ri3w",
+             authDomain: "vip-membership-b19fe.firebaseapp.com",
+             projectId: "vip-membership-b19fe",
+             storageBucket: "vip-membership-b19fe.appspot.com",
+             messagingSenderId: "1098738124176",
+             appId: "1:1098738124176:web:77ec1c338f627026729f15"
+         };
+ 
+         const app = initializeApp(firebaseConfig);
+         const db = getFirestore(app);
+         const userRef = doc(db, "users", "vip-user");
+         const transactionsRef = collection(userRef, "transactions");
+         const rewardsRef = collection(userRef, "rewards");
+         const chatsRef = collection(userRef, "chats");
+         const diaryRef = collection(userRef, "diary");
+ 
+        let currentSender = "liang";
+        let recorder = null;
+        let isRecording = false;
+        let currentAudio = null;
+        let copyToastTimer = null;
+
+        function copyLiveSiteUrl() {
+            const url = "https://vip-membership-b19fe.web.app/";
+            const fallbackCopy = () => {
+                const textarea = document.createElement("textarea");
+                textarea.value = url;
+                document.body.appendChild(textarea);
+                textarea.select();
+                try {
+                    document.execCommand("copy");
+                    showCopyToast("å·²å¤åˆ¶ï¼Œç²˜è´´åˆ°æµè§ˆå™¨åœ°å€æ å³å¯ï¼");
+                } catch (err) {
+                    showCopyToast("è¯·æ‰‹åŠ¨å¤åˆ¶ï¼š" + url);
+                }
+                document.body.removeChild(textarea);
+            };
+
+            if (navigator.clipboard && navigator.clipboard.writeText) {
+                navigator.clipboard.writeText(url)
+                    .then(() => showCopyToast("å·²å¤åˆ¶ï¼Œç²˜è´´åˆ°æµè§ˆå™¨åœ°å€æ å³å¯ï¼"))
+                    .catch(() => fallbackCopy());
+            } else {
+                fallbackCopy();
+            }
+        }
+
+        function showCopyToast(message) {
+            const toast = document.getElementById("copyLinkToast");
+            if (!toast) return;
+            toast.textContent = message;
+            toast.classList.add("visible");
+            if (copyToastTimer) {
+                clearTimeout(copyToastTimer);
+            }
+            copyToastTimer = setTimeout(() => {
+                toast.classList.remove("visible");
+            }, 2000);
+        }
+
+        async function loadPoints() {
+            const spinner = document.getElementById("spinner");
+             spinner.style.display = "block";
+             try {
+                 const docSnap = await getDoc(userRef);
+                 if (docSnap.exists()) {
+                     const data = docSnap.data();
+                     updatePointsDisplay(data.points || 0);
+                     updateStreakDisplay(data.streak || 0, data.lastCheckIn);
+                 } else {
+                     await setDoc(userRef, { points: 0, streak: 0, lastCheckIn: null });
+                     updatePointsDisplay(0);
+                     updateStreakDisplay(0, null);
+                 }
+                 loadHistory();
+                 loadRewards();
+                 startCountdown();
+                 loadPlaylist();
+             } catch (error) {
+                 console.error("åŠ è½½ç§¯åˆ†å¤±è´¥:", error);
+             }
+             spinner.style.display = "none";
+         }
+ 
+         async function adjustPoints() {
+             const spinner = document.getElementById("spinner");
+             spinner.style.display = "block";
+             const playlist = document.getElementById("playlist");
+             const songs = [
+                 { name: "Flower Dance", url: "https://www.dropbox.com/scl/fi/yiry4syd84w5uesrdehg4/SOUNDZ-under-GROUND-DJ-Okawari-Tabeyellow-Flower-Dance.mp3?rlkey=n00uozba5xd3po4iyiiogcfd7&st=d9gon05a&raw=1" },
+                 { name: "Need You Now", url: "https://www.dropbox.com/scl/fi/l08rq49ao7y8siv5vwa02/Lady-Antebellum-Need-You-Now.mp3?rlkey=1y7sbd3druy1g0mrafuwz1xof&st=d3f7r56a&raw=1" },
+                 { name: "Close to You", url: "https://www.dropbox.com/scl/fi/wy4v3cn11uwseh14hyb9a/Carpenters_They_Long_To_Be_Close_To_You.mp3?rlkey=oxh880tv5shrp6jygagxvw3t3&st=ocdxuzwc&raw=1" }
+             ];
+ 
+             playlist.innerHTML = "";
+             songs.forEach((song, index) => {
+                 const div = document.createElement("div");
+                 const audio = document.createElement("audio");
+                 audio.controls = true;
+                 audio.src = song.url;
+                 audio.addEventListener("play", () => {
+                     if (currentAudio && currentAudio !== audio) {
+                         currentAudio.pause();
+                     }
+                     currentAudio = audio;
+                 });
+                 div.textContent = `${index + 1}. ${song.name} `;
+                 div.appendChild(audio);
+                 playlist.appendChild(div);
+             });
+         }
+ 
+        function toggleSection(header) {
+            const content = header.nextElementSibling;
+            content.classList.toggle("active");
+        }
+
+        function parseHighlights(text) {
+            return text
+                .split(/[\n,ï¼Œã€]/)
+                .map(item => item.trim())
+                .filter(Boolean);
+        }
+
+        function generateJobReply() {
+            const spinner = document.getElementById("spinner");
+            spinner.style.display = "block";
+
+            const getValue = (id, fallback = "") => {
+                const el = document.getElementById(id);
+                return (el ? el.value.trim() : "") || fallback;
+            };
+
+            const name = getValue("agentName", "å†¯é’°èŒœ");
+            const title = getValue("agentTitle", "äº§å“è¿è¥ç»ç†");
+            const contact = getValue("agentContact");
+            const location = getValue("agentLocation", "æ–°åŠ å¡");
+            const summary = getValue("agentSummary", "çƒ­çˆ±æ„å»ºä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„äº§å“ä½“éªŒã€‚");
+            const highlights = parseHighlights(getValue("agentHighlights"));
+            const jobCompany = getValue("jobCompany");
+            const jobTitle = getValue("jobTitle");
+            const jobDetails = getValue("jobDetails");
+            const extras = getValue("agentExtras");
+            const toneKey = getValue("agentTone", "application");
+
+            const toneProfiles = {
+                application: {
+                    greeting: "ä½ å¥½{{team}}ï¼š",
+                    focus: "æ„Ÿè°¢ä½ ä»¬å‘å¸ƒ{{jobLine}}çš„æœºä¼šã€‚",
+                    callToAction: "è‹¥æ–¹ä¾¿çš„è¯ï¼ŒæœŸå¾…çº¦ä¸€ä¸ªæ—¶é—´ï¼Œè®¨è®ºæˆ‘å¯ä»¥å¦‚ä½•å¸®åŠ©å›¢é˜Ÿåœ¨æ–°åŠ å¡å¸‚åœºè½åœ°æˆæœã€‚",
+                    closing: "ç¥ä¸€åˆ‡é¡ºåˆ©ï¼ŒæœŸå¾…å›å¤ã€‚"
+                },
+                followup: {
+                    greeting: "æ‚¨å¥½{{team}}ï¼š",
+                    focus: "æˆ‘æƒ³è·Ÿè¿›ä¹‹å‰æäº¤çš„{{jobLine}}ç”³è¯·ï¼ŒåŒæ—¶è¡¥å……ä¸€äº›æˆ‘èƒ½å¤Ÿå³åˆ»è´¡çŒ®çš„æƒ³æ³•ã€‚",
+                    callToAction: "å¦‚éœ€é¢å¤–ææ–™æˆ–æ¡ˆä¾‹ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šç«‹åˆ»è¡¥å……ã€‚",
+                    closing: "æ„Ÿè°¢æŠ½ç©ºé˜…è¯»ã€‚"
+                },
+                network: {
+                    greeting: "å—¨{{team}}ï¼š",
+                    focus: "æˆ‘æƒ³äº†è§£è´µå¸ç›®å‰å…³äº{{jobLine}}çš„æ‹›è˜é‡ç‚¹ï¼Œå¹¶çœ‹çœ‹æ˜¯å¦æœ‰åˆä½œæˆ–å†…æ¨çš„å¯èƒ½ã€‚",
+                    callToAction: "è‹¥å›¢é˜Ÿåˆé€‚ï¼Œè¿˜è¯·æŒ‡ç‚¹ä¸‹ä¸€æ­¥æˆ–æ¨èå¯ä»¥æ²Ÿé€šçš„åŒäº‹ã€‚",
+                    closing: "å†æ¬¡æ„Ÿè°¢ï¼Œä¹Ÿç¥å·¥ä½œé¡ºåˆ©ï¼"
+                }
+            };
+
+            const toneProfile = toneProfiles[toneKey] || toneProfiles.application;
+            const teamLabel = jobCompany ? `${jobCompany}å›¢é˜Ÿ` : "æ‹›è˜å›¢é˜Ÿ";
+            const jobLine = jobTitle ? `${jobTitle} å²—ä½` : "çš„å²—ä½æœºä¼š";
+            const companyLabel = jobCompany || "è´µå…¬å¸";
+            const greeting = toneProfile.greeting.replace("{{team}}", teamLabel);
+            const focusLine = toneProfile.focus.replace("{{jobLine}}", jobLine);
+            const detailsLine = jobDetails ? `æˆ‘ç‰¹åˆ«å…³æ³¨åˆ°ï¼š${jobDetails}ã€‚` : "";
+            const introParts = [`æˆ‘æ˜¯${name}`];
+            if (title) introParts.push(`ä¸€å${title}`);
+            if (location) introParts.push(`ç›®å‰å¸¸é©»${location}`);
+            const intro = `${introParts.join("ï¼Œ")}ã€‚${summary}`;
+            const highlightText = highlights.length ? `\næ ¸å¿ƒäº®ç‚¹ï¼š\n${highlights.map(item => `â€¢ ${item}`).join("\n")}` : "";
+            const extrasText = extras ? `\né¢å¤–å¤‡æ³¨ï¼š${extras}` : "";
+            const contactLine = contact ? `å¯é€šè¿‡ ${contact} è”ç³»æˆ‘ã€‚` : "å¯ä»¥éšæ—¶ä¸æˆ‘è”ç³»ã€‚";
+            const visaLine = "ä½œä¸ºä¸­å›½å…¬æ°‘ï¼Œæˆ‘æ¸…æ¥šéœ€è¦é›‡ä¸»æ”¯æŒåŠç†æ–°åŠ å¡ Employment Pass æˆ– S Passï¼Œæ‰€æœ‰ææ–™å·²å‡†å¤‡å¥½å¹¶å¯ç§¯æé…åˆã€‚";
+
+            const body = `${focusLine} ${detailsLine}æˆ‘ç›¸ä¿¡è¿™äº›ç»éªŒèƒ½å¤Ÿå¸®åŠ©${companyLabel}åœ¨æ–°åŠ å¡å¸‚åœºæ›´å¿«å…‘ç°ç›®æ ‡ã€‚`;
+            const message = `${greeting}\n\n${intro}\n${body}${highlightText}\n${visaLine}${extrasText}\n\n${toneProfile.callToAction}\n${contactLine}\n${toneProfile.closing}\n${name}`;
+
+            const replyBox = document.getElementById("jobReply");
+            replyBox.value = message.trim();
+            spinner.style.display = "none";
+        }
+
+        const honorHeroGuides = {
+            "éœ²å¨œ": {
+                title: "æœˆä¸‹æ— é™è¿æ³•åˆº",
+                variants: {
+                    "æ‰“é‡": {
+                        build: ["è¿½å‡»åˆ€é”‹(è´ªå©ªä¹‹å™¬)", "æŠµæŠ—ä¹‹é´", "å™¬ç¥ä¹‹ä¹¦", "æå¯’é£æš´", "åšå­¦è€…ä¹‹æ€’", "è´¤è€…ä¹‹ä¹¦"],
+                        runes: { red: "æ¢¦é­‡*10", green: "æ€œæ‚¯*10", blue: "ç‹©çŒ*10" },
+                        spell: "æƒ©å‡»",
+                        focus: "åˆ·å¤§æ‹›åˆ·æ–°è¢«åŠ¨ï¼Œè¿æ®µè¡”æ¥ä¸æ–­è“",
+                        combos: "12A-å¤§æ‹›-1A-2A-åˆ·æ–°å¤§æ‹›ï¼Œå°½é‡åˆ©ç”¨å¢™ä½“æ ‡è®°",
+                        tips: ["å‰æœŸå¤šé äºŒæŠ€èƒ½ç©¿å¢™æŠ¢è§†é‡ï¼Œä¿è¯è“åŒºèŠ‚å¥", "å›¢æˆ˜åˆ‡å…¥å‰å…ˆè¹­èƒ½é‡ï¼Œåˆ©ç”¨æå¯’é¡¶ä½é¦–è½®æ§åˆ¶"]
+                    },
+                    "å¯¹æŠ—è·¯": {
+                        build: ["ç§˜æ³•ä¹‹é´", "å™¬ç¥ä¹‹ä¹¦", "ç—›è‹¦é¢å…·", "æå¯’é£æš´", "åšå­¦è€…ä¹‹æ€’", "è¾‰æœˆ"],
+                        runes: { red: "æ¢¦é­‡*10", green: "å¿ƒçœ¼*10", blue: "ç‹©çŒ*10" },
+                        spell: "é—ªç°",
+                        focus: "èµ–çº¿æ¸…å…µï¼Œè¹­å¤§æ‹›åˆ‡å",
+                        combos: "æ™®æ”»å å°è®°â†’2æŠ€èƒ½è¿›åœºâ†’1æŠ€èƒ½æ‰“ä¼¤å®³â†’å¤§æ‹›æ”¶å‰²",
+                        tips: ["å…µçº¿è¿›å¡”å‰æå‰æ’çœ¼é˜²æ­¢è¢«æŠ“", "æœ‰è¾‰æœˆæ—¶å¯ä»¥å¼ºåˆ‡åæ’æ‰“æé™1æ¢å¤š"]
+                    }
+                }
+            },
+            "æç™½": {
+                title: "çµæ´»çˆ†å‘åˆºå®¢",
+                variants: {
+                    "æ‰“é‡": {
+                        build: ["è´ªå©ªä¹‹å™¬", "æŠµæŠ—ä¹‹é´", "æš—å½±æˆ˜æ–§", "å®—å¸ˆä¹‹åŠ›", "ç ´å†›", "ååˆ€Â·å¸å‘½"],
+                        runes: { red: "ç¥¸æº*10", green: "é¹°çœ¼*10", blue: "ç‹©çŒ*10" },
+                        spell: "æƒ©å‡»",
+                        focus: "ç¡®ä¿å››ä¸‹æ™®æ”»é‡Šæ”¾å¤§æ‹›",
+                        combos: "12A-å¤§æ‹›-å›æ‹‰äºŒæŠ€èƒ½",
+                        tips: ["å…¥ä¾µæ—¶å…ˆåˆ·å¥½è¢«åŠ¨ï¼Œç­‰æ§åˆ¶äº¤è¿‡å†è¿›", "å¤§æ‹›è¦†ç›–é¢å¤§ï¼Œåˆ©ç”¨è‰ä¸›å¡è§†é‡"]
+                    },
+                    "å¯¹æŠ—è·¯": {
+                        build: ["å½±å¿ä¹‹è¶³", "æš—å½±æˆ˜æ–§", "æ— å°½æˆ˜åˆƒ", "å®—å¸ˆä¹‹åŠ›", "ç ´å†›", "ååˆ€Â·å¸å‘½"],
+                        runes: { red: "æ— åŒ*10", green: "é¹°çœ¼*10", blue: "ç‹©çŒ*10" },
+                        spell: "é—ªç°",
+                        focus: "åˆ©ç”¨ä½ç§»æ‹–å»¶",
+                        combos: "1A-2ç©¿å¢™-å›æ‹‰-å¤§æ‹›æ”¶",
+                        tips: ["å…µçº¿æ§åœ¨å¡”å‰éª—æŠ€èƒ½", "æœ‰é—ªç°æ—¶å¯åå‘å¤§æ‹›å°èµ°ä½"]
+                    }
+                }
+            },
+            "ç‹„ä»æ°": {
+                title: "å‘è‚²è·¯å…¨èƒ½å°„æ‰‹",
+                variants: {
+                    "å‘è‚²è·¯": {
+                        build: ["æ€¥é€Ÿæˆ˜é´", "æœ«ä¸–", "çº¯å‡€è‹ç©¹", "é€æ—¥ä¹‹å¼“", "ç ´æ™“", "æ— å°½æˆ˜åˆƒ"],
+                        runes: { red: "æ— åŒ*10", green: "é¹°çœ¼*10", blue: "ç‹©çŒ*10" },
+                        spell: "å‡€åŒ–",
+                        focus: "åŒæ ‡è®°æ‰“çŸ­æ¢",
+                        combos: "çº¢æ ‡å®šèº«â†’é»„æ ‡æ‹‰æ‰¯â†’æ™®æ”»è¾“å‡º",
+                        tips: ["éšæ—¶ç•™é»„ç‰Œä¿å‘½ï¼Œå‡€åŒ–é…åˆäºŒæŠ€èƒ½è§£æ§", "é€æ—¥+çº¯å‡€è®©ä½ åœ¨å›¢æˆ˜ç«™å¾—æ›´è¿œ"]
+                    }
+                }
+            },
+            "æ¾œ": {
+                title: "æš—å½±æ½œè¡Œæ‰“é‡",
+                variants: {
+                    "æ‰“é‡": {
+                        build: ["å·¨äººä¹‹æ¡", "æŠµæŠ—ä¹‹é´", "æš—å½±æˆ˜æ–§", "å®—å¸ˆä¹‹åŠ›", "ç¢æ˜Ÿé”¤", "ç ´å†›"],
+                        runes: { red: "å¼‚å˜*10", green: "é¹°çœ¼*10", blue: "ç‹©çŒ*10" },
+                        spell: "æƒ©å‡»",
+                        focus: "æ²³é“ç–¾è·‘æ¸¸èµ°",
+                        combos: "æ°´å½¢æ€1â†’æ™®æ”»â†’2â†’å¤§æ‹›å›èº«",
+                        tips: ["æ²³é“æ°´ä½“å°±æ˜¯ä½ çš„é«˜é€Ÿå…¬è·¯ï¼Œç›¯ç´§å…ˆæ‰‹æœºä¼š", "å¤§æ‹›åçš„å…ä¼¤å¾ˆé«˜ï¼Œå¯ä»¥ç¡¬åƒç¬¬ä¸€æ³¢çˆ†å‘"]
+                    }
+                }
+            },
+            "ç‹æ˜­å›": {
+                title: "å›¢æ§çˆ†å‘æ³•å¸ˆ",
+                variants: {
+                    "ä¸­è·¯": {
+                        build: ["å†·é™ä¹‹é´", "å›å“ä¹‹æ–", "ç—›è‹¦é¢å…·", "åšå­¦è€…ä¹‹æ€’", "è¾‰æœˆ", "è™šæ— æ³•æ–"],
+                        runes: { red: "æ¢¦é­‡*10", green: "çŒ®ç¥­*10", blue: "è°ƒå’Œ*10" },
+                        spell: "é—ªç°",
+                        focus: "å¤§æ‹›æ§é¾™å‘",
+                        combos: "2æŠ€èƒ½å‡é€Ÿâ†’1æŠ€èƒ½å†°å†»â†’å¤§æ‹›è¦†ç›–",
+                        tips: ["å…ˆæ‰‹äºŒæŠ€èƒ½å‘½ä¸­ç‡=å›¢æˆ˜èƒœç‡ï¼Œå°½é‡è´´å¢™æ”¾", "å¤§æ‹›è¦†ç›–é‡åŒºçª„å£ï¼Œé€¼è¿«å¯¹é¢è®©èµ„æº"]
+                    }
+                }
+            }
+        };
+
+        const honorFallback = {
+            build: ["å†·é™ä¹‹é´", "åšå­¦è€…ä¹‹æ€’", "è´¤è€…ä¹‹ä¹¦", "è¾‰æœˆ", "è™šæ— æ³•æ–", "ç—›è‹¦é¢å…·"],
+            runes: { red: "æ¢¦é­‡*10", green: "å¿ƒçœ¼*10", blue: "ç‹©çŒ*10" },
+            spell: "æ ¹æ®åˆ†è·¯è‡ªé€‰", 
+            focus: "ä¿æŒç»æµé¢†å…ˆ",
+            combos: "åˆ©ç”¨æŠ€èƒ½è¡”æ¥æ‰“å‡ºæ§åˆ¶",
+            tips: ["å¤šçœ‹å°åœ°å›¾ï¼Œç¡®ä¿è§†é‡", "æ ¹æ®å±€åŠ¿è°ƒæ•´ç¬¬ä¸‰ä»¶è£…å¤‡"]
+        };
+
+        const honorStyleNotes = {
+            "ç¨³å¥è¿è¥": "å…ˆå®ˆä½å‘è‚²æ›²çº¿ï¼Œç­‰ä¸¤ä»¶æ ¸å¿ƒè£…åå†æ¥å›¢ï¼Œé‡è§†å…µçº¿èµ„æºã€‚",
+            "æé™è¿›æ”»": "è§†é‡ç¡®è®¤åå…ˆæ‰‹ï¼Œæ‰“å®ŒæŠ€èƒ½ç«‹å³åˆ©ç”¨ä½ç§»æˆ–é—ªç°æ‹‰å¼€ã€‚",
+            "åè¹²åæ‰“": "æŠŠæŠ€èƒ½ç•™åˆ°å¯¹é¢å¼€å›¢ä¹‹åï¼Œåæ‰“æ—¶ä¼˜å…ˆå¤„ç†æ— ä½ç§»Cä½ã€‚",
+            "å¸¦çº¿ç‰µåˆ¶": "æå‰æ’çœ¼ï¼Œé€¼å‡ºå¯¹é¢æ§åˆ¶åç”¨ä½ç§»æ’¤èµ°ï¼Œåˆ›é€ äººæ•°å·®ã€‚"
+        };
+
+        function formatRunes(runes) {
+            return Object.entries(runes)
+                .map(([color, text]) => `${color}ï¼š${text}`)
+                .join(" ï½œ ");
+        }
+
+        function generateHonorGuide() {
+            const spinner = document.getElementById("spinner");
+            spinner.style.display = "block";
+
+            const hero = document.getElementById("honorHero").value;
+            const lane = document.getElementById("honorLane").value;
+            const style = document.getElementById("honorStyle").value;
+            const focus = document.getElementById("honorFocus").value.trim();
+            const enemy = document.getElementById("honorEnemy").value.trim();
+
+            const heroInfo = honorHeroGuides[hero];
+            const variant = heroInfo?.variants?.[lane] || heroInfo?.variants?.["æ‰“é‡"] || honorFallback;
+            const tips = [...(variant.tips || [] )];
+
+            if (enemy) {
+                tips.push(`é’ˆå¯¹ ${enemy}ï¼šä¼˜å…ˆä¿ç•™å…³é”®æ§åˆ¶/ä½ç§»ï¼Œå¿…è¦æ—¶åšå‡ºä¸æ­»é¸Ÿã€é­”å¥³ç­‰é˜²å…·æ¥å¯¹å†²ä¼¤å®³ã€‚`);
+            }
+            if (focus) {
+                tips.push(`ä¸ªäººæ‰“æ³•ï¼š${focus}ï¼Œå»ºè®®åœ¨è®­ç»ƒè¥å¤šç»ƒï¼Œç¡®ä¿ä¸é˜Ÿå‹æ²Ÿé€šä½ çš„èŠ‚å¥ã€‚`);
+            }
+            tips.push(honorStyleNotes[style]);
+
+            const heroTitle = heroInfo?.title ? `${hero}ï½œ${heroInfo.title}` : hero;
+            const build = (variant.build || honorFallback.build).join(" â†’ ");
+            const runeText = formatRunes(variant.runes || honorFallback.runes);
+            const spell = variant.spell || honorFallback.spell;
+            const combo = variant.combos || honorFallback.combos;
+            const focusLine = variant.focus || honorFallback.focus;
+
+            const html = `
+                <h3>${heroTitle}</h3>
+                <p><strong>æ¨èåˆ†è·¯ï¼š</strong>${lane} ï½œ <strong>æ‰“æ³•å€¾å‘ï¼š</strong>${style}</p>
+                <p><strong>å‡ºè£…é¡ºåºï¼š</strong>${build}</p>
+                <p><strong>é“­æ–‡/ç¬¦æ–‡ï¼š</strong>${runeText}</p>
+                <p><strong>å¬å”¤å¸ˆæŠ€èƒ½ï¼š</strong>${spell}</p>
+                <p><strong>è¿æ‹›èŠ‚å¥ï¼š</strong>${combo}</p>
+                <p><strong>æ ¸å¿ƒæ€è·¯ï¼š</strong>${focusLine}</p>
+                <p><strong>ç»†èŠ‚æç¤ºï¼š</strong></p>
+                <ul>${tips.map(item => `<li>${item}</li>`).join("")}</ul>
+            `;
+
+            const output = document.getElementById("honorCoachOutput");
+            output.innerHTML = html;
+            spinner.style.display = "none";
+        }
+ 
+         document.addEventListener("DOMContentLoaded", () => {
+             const chatBubble = document.getElementById("chatBubble");
+             const chatContainer = document.getElementById("chatContainer");
+             currentX = window.innerWidth - 70;
+             currentY = window.innerHeight - 70;
+             chatBubble.style.left = `${currentX}px`;
+             chatBubble.style.top = `${currentY}px`;
+             chatContainer.style.left = `${currentX}px`;
+             chatContainer.style.top = `${currentY + 60}px`;
+ 
+             chatBubble.addEventListener("mousedown", startDragging);
+             chatContainer.addEventListener("mousedown", startDragging);
+             document.addEventListener("mousemove", drag);
+             document.addEventListener("mouseup", stopDragging);
+             chatBubble.addEventListener("touchstart", startDragging);
+             chatContainer.addEventListener("touchstart", startDragging);
+             document.addEventListener("touchmove", drag);
+             document.addEventListener("touchend", stopDragging);
+             chatBubble.addEventListener("click", (e) => { if (!isDragging) toggleChat(); });
+ 
+             document.getElementById("audioToggle").textContent = "å¼€å¯éŸ³ä¹";
+             if (localStorage.getItem("darkMode") === "true") {
+                 document.body.classList.add("dark-mode");
+                 addStars();
+ 
+             const loadingScreen = document.getElementById("loadingScreen");
+             setTimeout(() => {
+                 loadingScreen.classList.add("fade-out");
+                 setTimeout(() => loadingScreen.style.display = "none", 500);
+             }, 1000);
+         });
+ 
+         document.getElementById("chatInput").addEventListener("keypress", (e) => {
+             if (e.key === "Enter") sendMessage();
+         });
+ 
+         window.adjustPoints = adjustPoints;
+         window.redeemSpecificReward = redeemSpecificReward;
+         window.addReward = addReward;
+         window.deleteReward = deleteReward;
+         window.sendMessage = sendMessage;
+         window.clearChat = clearChat;
+         window.startVoiceInput = startVoiceInput;
+         window.toggleChat = toggleChat;
+         window.toggleDarkMode = toggleDarkMode;
+         window.flipCard = flipCard;
+         window.toggleAudio = toggleAudio;
+         window.clearTransactionHistory = clearTransactionHistory;
+        window.saveDiaryEntry = saveDiaryEntry;
+        window.deleteDiaryEntry = deleteDiaryEntry;
+        window.dailyCheckIn = dailyCheckIn;
+        window.toggleSection = toggleSection;
+        window.generateJobReply = generateJobReply;
+        window.generateHonorGuide = generateHonorGuide;
+    </script>
+</body>
+</html>
